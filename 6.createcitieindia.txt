
6.Create
CitiesIndia(pincode,nameofcity,earliername,area,population,avgrainfall)

tables

Categories(Type,pincode) Note:- Enter data only in CitiesIndia
Write PL/SQL Procedure & function to find the population density of the cities. If
the population density is above 3000 then Type of city must be entered as High Density
in Category table. Between 2999 to 1000 as Moderate and below 999 as Low Density.
Error must be displayed for population less than 10 or greater than 25718.
CREATE TABLE CitiesIndia (
pincode INT PRIMARY KEY,
nameofcity VARCHAR(100),
earliername VARCHAR(100),
area DECIMAL(10,2),

-- in sq km

population INT,
avgrainfall DECIMAL(6,2) -- in mm
);
CREATE TABLE Categories (
Type VARCHAR(20),
pincode INT,
FOREIGN KEY (pincode) REFERENCES CitiesIndia(pincode)
);
INSERT INTO CitiesIndia VALUES (110001, 'New Delhi', 'Delhi', 1484.0, 25000, 800);
INSERT INTO CitiesIndia VALUES (560001, 'Bangalore', 'Bengaluru', 709.5, 8500, 970);
INSERT INTO CitiesIndia VALUES (400001, 'Mumbai', 'Bombay', 603.4, 12000, 2100);

INSERT INTO CitiesIndia VALUES (700001, 'Kolkata', 'Calcutta', 185.0, 300, 1500);
DELIMITER $$
CREATE FUNCTION get_population_density(p_pincode INT) RETURNS DECIMAL(10,2)
DETERMINISTIC
BEGIN
DECLARE v_area DECIMAL(10,2);
DECLARE v_population INT;
DECLARE v_density DECIMAL(10,2);
SELECT area, population INTO v_area, v_population FROM CitiesIndia WHERE pincode = p_pincode;
IF v_population < 10 OR v_population > 25718 THEN
SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Error: Population is out of allowed range (10-25718)';
END IF;
SET v_density = v_population / v_area;
RETURN v_density;
END$$
DELIMITER ;

DELIMITER $$
CREATE PROCEDURE update_city_category(IN p_pincode INT)
BEGIN
DECLARE v_density DECIMAL(10,2);
DECLARE v_type VARCHAR(20);
SET v_density = get_population_density(p_pincode);
IF v_density > 3000 THEN
SET v_type = 'High Density';
ELSEIF v_density BETWEEN 1000 AND 2999 THEN
SET v_type = 'Moderate Density';
ELSE
SET v_type = 'Low Density';
END IF;
INSERT INTO Categories(Type, pincode) VALUES (v_type, p_pincode);
END$$
DELIMITER ;

CALL update_city_category(110001);
CALL update_city_category(560001);
CALL update_city_category(400001);
CALL update_city_category(700001);
SELECT * FROM Categories;
